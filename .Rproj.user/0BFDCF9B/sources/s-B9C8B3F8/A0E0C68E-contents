---
title: "Homework 5"
author: "Daniela Rochez"
date: "11/15/2021"
output: github_document
editor_options: 
  chunk_output_type: console
---

```{r}
library(tidyverse)
library(rvest)
set.seed(1)
```

#Loading the Excel Files and creating a function for reading them
```{r}
all_files=list.files(path= "long data")
```
```{r}
reading_data= function(x){
  read=read_csv(x)
  read
}
```


#Applying the function using map to create a data frame
```{r}
subject_df= 
  purrr::map_df(all_files,reading_data,.id = "subject_id")
```
#Adding new variables for subjects
```{r}
new_df=
  subject_df %>% 
  mutate(subject_id= all_files) %>% 
  mutate(other_data= all_files) 
```

#Tidying the data and separatinf variables
```{r}
tidy_data=
  pivot_longer(
    new_df, 
    week_1:week_8,
    names_to = "week", 
    names_prefix = "week_",
    values_to = "observations") %>% 
  separate(
    subject_id, into = c("arm", "other"), 
    sep = "_")%>% 
  separate(
    other_data, into = c("subject_id", "other"), 
    sep = "\\.")%>%
  relocate(subject_id) %>% 
  select(-other) %>% 
  mutate(week= as.numeric(week)) 
```

#Creating a spaghetti plot
```{r}
tidy_data %>% 
  ggplot(
    aes(x = week,y = observations,
        color=subject_id))+
  geom_line()

#Um is this right???
```

#It seems like the experimental has higher observations than the control arm.